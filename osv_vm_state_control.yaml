---
- name: OSV_VM_State Control  
  hosts: localhost
  gather_facts: false
  become: false
  vars:
     # vm_inventory_hostname
     # vm_namespace
  
  
  tasks:
    - name: Debug multilist
      ansible.builtin.debug:
        var: multiple_targets
   
    - name: Stop {{ vm_inventory_hostname }} in {{ vm_namespace }} 
      redhat.openshift_virtualization.kubevirt_vm:
        state: present
        validate_certs: false
        name: "{{ vm_inventory_hostname }}"
        namespace: "{{ vm_namespace }}"
        running: false 
      loop: "{{ multiple_host }}"  
      when: wantedstate == "Stop" or wantedstate == "Reboot"
    
    - name: Start {{ vm_inventory_hostname }} in  {{ vm_namespace }} 
      redhat.openshift_virtualization.kubevirt_vm:
        state: present
        validate_certs: false
        name: "{{ vm_inventory_hostname }}"
        namespace: "{{ vm_namespace }}"
        running: true 
      loop: "{{ multiple_host }}"
      when: wantedstate == "Start" or wantedstate == "Reboot"
             
